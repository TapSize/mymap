<!DOCTYPE html>

<html lang="uk">
<head>
<meta charset="utf-8"/>
<title>–ö–∞—Ä—Ç–∞ –≤–µ—Ä—Ç–æ–ª—ñ—Ç–Ω–∏—Ö –º–∞–π–¥–∞–Ω—á–∏–∫—ñ–≤</title>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" rel="stylesheet"/>
<style>
    html, body {
      margin: 0; height: 100%;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #1e1e1e;
    }
    #map { width: 100%; height: 100%; }

    .info-panel {
      position: absolute; top: 0; right: 0; width: 300px; height: 100%;
      background-color: rgba(0, 0, 0, 0.7); color: #fff;
      padding: 20px; overflow-y: auto; display: none; z-index: 1000;
    }
    .info-panel h2 { margin-top: 0; }
    .close-btn {
      width: 100%; background: #2a2a2a; color: #dddddd;
      border: none; border-top: 1px solid #444;
      padding: 12px 0; font-size: 16px; cursor: pointer; margin-top: 20px;
    }
    #helipadMiniMap {
      height: 200px; width: 100%;
      border-radius: 8px; margin-bottom: 10px;
    }

    #mapContextBtn {
      position: absolute; bottom: 20px; left: 20px;
      background: none; border: none; cursor: pointer;
      width: 40px; height: 40px;
      background-image: url('https://i.ibb.co/tTSG976d/Map-Change-removebg-preview-1.png');
      background-size: contain; background-repeat: no-repeat;
      z-index: 1100;
    }

    .minimal-black-menu {
      position: absolute; bottom: 70px; left: 20px;
      background: rgba(30, 30, 30, 0.95);
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
      display: none; flex-direction: column;
      padding: 8px 0;
      z-index: 1100;
      min-width: 160px;
    }

    .minimal-black-menu button {
      background: transparent;
      border: none;
      color: #f1f1f1;
      padding: 10px 16px;
      text-align: left;
      font-size: 14px;
      width: 100%;
      cursor: pointer;
    }

    .minimal-black-menu button:hover {
      background-color: rgba(255, 255, 255, 0.1);
    }
  
@keyframes glow {
  0% { box-shadow: 0 0 0px #7cadd7; }
  50% { box-shadow: 0 0 12px #7cadd7; }
  100% { box-shadow: 0 0 0px #7cadd7; }
}
.leaflet-marker-icon.glow {
  animation: glow 2s infinite ease-in-out;
  border-radius: 50%;
}

#returnToLocationBtn {
  position: absolute;
  bottom: 70px;
  left: 20px;
  background: none;
  border: none;
  cursor: pointer;
  width: 40px;
  height: 40px;
  background-image: url('https://i.ibb.co/HfwB35rn/Chat-GPT-Image-18-2025-09-51-16-1.png');
  background-size: contain;
  background-repeat: no-repeat;
  z-index: 1100;
}

#zoomMenu button {
  background: #444;
  border: none;
  color: white;
  padding: 6px 10px;
  font-size: 13px;
  border-radius: 4px;
  cursor: pointer;
}
#zoomMenu button:hover {
  background: #666;
}
</style>
<style>
@keyframes alertBlink {
  0% { opacity: 1; }
  50% { opacity: 0.5; }
  100% { opacity: 1; }
}
@import url('https://fonts.googleapis.com/css2?family=Rubik+Glitch+Pop&display=swap');

.alert-message {
  color: white;
  font-family: 'Rubik Glitch Pop', sans-serif;
  font-size: 14px;
  margin-top: 12px;
  animation: alertBlink 2s infinite;
  text-align: center;
}
</style></head>
<body>
<!-- –ö–Ω–æ–ø–∫–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞ –∫ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—é -->
<button id="returnToLocationBtn" title="–î–æ –º–æ–≥–æ –º—ñ—Å—Ü–µ—Ä–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è"></button>
<div id="map"></div>
<!-- –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é MinimalBlack -->
<button id="mapContextBtn" title="–ü—ñ–¥–ª–æ–∂–∫–∞ –∫–∞—Ä—Ç–∏"></button>
<div class="minimal-black-menu" id="mapContextMenu">
<button data-style="dark">–¢–µ–º–Ω–∞</button>
<button data-style="streets">–í—É–ª–∏—Ü—ñ</button>
<button data-style="satellite">–°—É–ø—É—Ç–Ω–∏–∫</button>
</div>
<!-- –ü–∞–Ω–µ–ª—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ -->
<div class="info-panel" id="infoPanel">
<div id="helipadMiniMap"></div>
<h2 id="helipadTitle"></h2>
<p id="helipadDescription"></p>
<button class="close-btn" onclick="document.getElementById('infoPanel').style.display='none'">–ó–∞–∫—Ä–∏—Ç–∏</button>
</div>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
  const map = L.map('map', { minZoom: 4 }).setView([49.95, 23.2], 10);
  const tileLayers = {
    dark: L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
      attribution: 'CARTO', subdomains: 'abcd', maxZoom: 19
    }),
    streets: L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; OpenStreetMap contributors'
    }),
    satellite: L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
      attribution: 'ESRI', maxZoom: 19
    })
  };
  tileLayers.dark.addTo(map);

  const rawHelipads = [];

  const infoPanel = document.getElementById('infoPanel');
  const helipadTitle = document.getElementById('helipadTitle');
  const helipadDescription = document.getElementById('helipadDescription');
  let miniMap;

  function showMiniMap(lat, lng) {
    if (miniMap) miniMap.remove();
    miniMap = L.map('helipadMiniMap', {
      attributionControl: false, zoomControl: false, dragging: false,
      scrollWheelZoom: false, doubleClickZoom: false, boxZoom: false, keyboard: false
    }).setView([lat, lng], 17);
    tileLayers.satellite.addTo(miniMap);
  }

  const customIcon = new L.Icon({
    iconUrl: 'https://i.ibb.co/Lz8FnQxK/helipadicon.png',
    iconSize: [32, 32], iconAnchor: [16, 32], popupAnchor: [0, -32]
  });

  // –ö–Ω–æ–ø–∫–∞ –∏ –º–µ–Ω—é
  const mapContextBtn = document.getElementById('mapContextBtn');
  const mapContextMenu = document.getElementById('mapContextMenu');

  mapContextBtn.addEventListener('click', () => {
    mapContextMenu.style.display = mapContextMenu.style.display === 'flex' ? 'none' : 'flex';
  });

  document.querySelectorAll('#mapContextMenu button').forEach(btn => {
    btn.addEventListener('click', () => {
      const selected = btn.getAttribute('data-style');
      Object.values(tileLayers).forEach(layer => map.removeLayer(layer));
      tileLayers[selected].addTo(map);
      mapContextMenu.style.display = 'none';
    });
  });

  // –ú–µ—Ç–∫–∞ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è
  const myLocationIcon = L.icon({
    iconUrl: 'https://i.ibb.co/9HCj2p70/Chat-GPT-Image-18-2025-09-51-16.png',
    iconSize: [40, 40],
    iconAnchor: [20, 40],
    popupAnchor: [0, -40]
  });

  const myLocationLatLng = [49.95, 23.2];
  
navigator.geolocation.getCurrentPosition(function(position) {
  const myLocationLatLng = [position.coords.latitude, position.coords.longitude];
  let currentZoom = map.getZoom();

  function createScaledIcon(zoom) {
    const scale = zoom / 13;
    const size = Math.max(20, 40 * scale);
    return L.icon({
      iconUrl: 'https://i.ibb.co/9HCj2p70/Chat-GPT-Image-18-2025-09-51-16.png',
      iconSize: [size, size],
      iconAnchor: [size / 2, size],
      popupAnchor: [0, -size / 2],
      className: 'glow'
    });
  }

  const myMarker = L.marker(myLocationLatLng, {
    icon: createScaledIcon(currentZoom)
  }).addTo(map);

  map.setView(myLocationLatLng, 13);

  map.on('zoom', () => {
    const newZoom = map.getZoom();
    if (newZoom !== currentZoom) {
      currentZoom = newZoom;
      myMarker.setIcon(createScaledIcon(currentZoom));
    }
  });
});

  map.setView(myLocationLatLng, 13);
</script>
<script>
// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ –≤–æ–∑–≤—Ä–∞—Ç–∞ –∫ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—é
const returnBtn = document.getElementById('returnToLocationBtn');
returnBtn.addEventListener('click', () => {
  if (myMarker) {
    map.setView(myMarker.getLatLng(), 13);
  }
});
</script>
<div id="zoomMenu" style="position:absolute; top:10px; right:10px; background:rgba(30,30,30,0.95); border-radius:8px; padding:6px; z-index:1100; display:flex; gap:6px;">
<button data-label="1" data-zoom="13">1 –∫–º</button>
<button data-label="5" data-zoom="11">5 –∫–º</button>
<button data-label="10" data-zoom="10">10 –∫–º</button>
<button data-label="20" data-zoom="9">20 –∫–º</button>
<button data-label="50" data-zoom="8">50 –∫–º</button>
</div>
<div id="scaleText" style="position:absolute; bottom:10px; right:10px; color:white; background:rgba(0,0,0,0.5); padding:4px 8px; font-size:13px; border-radius:6px; z-index:1100;">
  –ú–∞—Å—à—Ç–∞–±...
</div>



<div style="position: absolute; bottom: 120px; left: 20px; z-index: 1100;">
<button id="openSnapshotMenu" style="background:#7cadd7; color:black; padding:8px 12px; font-size:14px; border:none; border-radius:6px; cursor:pointer;">
    üõ∞ –°—É–ø—É—Ç–Ω–∏–∫–æ–≤—ñ –∑–Ω—ñ–º–∫–∏
  </button>
<div id="snapshotMenu" style="display:none; position:absolute; top:-160px; left:0; background:rgba(30,30,30,0.95); border-radius:8px; padding:8px; width:240px;">
<div style="display:flex; flex-direction:column; gap:6px;">
<button class="serviceBtn" data-service="nasa" style="color:white; text-align:left; padding:6px; border-radius:6px; background:#444;">üì∑ NASA Worldview</button>
<button class="serviceBtn" data-service="sentinel" style="color:white; text-align:left; padding:6px; border-radius:6px; background:#444;">üõ∞ Sentinel Playground</button>
<button class="serviceBtn" data-service="zoom" style="color:white; text-align:left; padding:6px; border-radius:6px; background:#444;">üåé Zoom Earth</button>
</div>
</div>
<div id="sourceMenu" style="display:none; position:absolute; top:-80px; left:250px; background:rgba(30,30,30,0.95); border-radius:8px; padding:8px; width:220px;">
<div style="display:flex; flex-direction:column; gap:6px;">
<button id="manualCoords" style="color:white; text-align:left; padding:6px; border-radius:6px; background:#444;">‚úçÔ∏è –í–Ω–µ—Å—Ç–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏</button>
<button id="geoCoords" style="color:white; text-align:left; padding:6px; border-radius:6px; background:#444;">üìç –ó–∞ –º–æ—ó–º–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏</button>
</div>
</div>
</div>

<div id="loaderOverlay" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); z-index:2000; align-items:center; justify-content:center; flex-direction:column;">
<div class="spinner" style="width:60px; height:60px; border:6px solid #ccc; border-top:6px solid #7cadd7; border-radius:50%; animation:spin 1s linear infinite;"></div>
<div id="loaderMessage" style="color:white; margin-top:16px; font-size:16px;"></div><div class="alert-message">–ù–µ –∑–∞–∫—Ä–∏–≤–∞–π—Ç–µ —Å—Ç–æ—Ä—ñ–Ω–∫—É, –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î—Ç—å—Å—è —Å—É–ø—É—Ç–Ω–∏–∫–æ–≤–∞ –∫–∞—Ä—Ç–∞, —Ü–µ –º–æ–∂–µ –∑–∞–π–Ω—è—Ç–∏ –¥–µ—è–∫–∏–π —á–∞—Å (10-15 —Å–µ–∫—É–Ω–¥)</div>
</div>
<style>
@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
</style>
<script>
let myMarker = null;

function createScaledIcon(zoom) {
  const scale = zoom / 13;
  const size = Math.max(20, 40 * scale);
  return L.icon({
    iconUrl: 'https://i.ibb.co/9HCj2p70/Chat-GPT-Image-18-2025-09-51-16.png',
    iconSize: [size, size],
    iconAnchor: [size / 2, size],
    popupAnchor: [0, -size / 2],
    className: 'glow'
  });
}

navigator.geolocation.watchPosition(function(position) {
  const latlng = [position.coords.latitude, position.coords.longitude];

  if (!myMarker) {
    myMarker = L.marker(latlng, {
      icon: createScaledIcon(map.getZoom())
    }).addTo(map);

    map.on('zoom', () => {
      if (myMarker) {
        myMarker.setIcon(createScaledIcon(map.getZoom()));
      }
    });
  } else {
    myMarker.setLatLng(latlng);
  }
}, function(error) {
  console.error("Geolocation error:", error.message);
}, {
  enableHighAccuracy: true,
  maximumAge: 10000,
  timeout: 5000
});
</script><script>
let selectedService = "";

document.getElementById('openSnapshotMenu').addEventListener('click', () => {
  const menu = document.getElementById('snapshotMenu');
  menu.style.display = (menu.style.display === 'none') ? 'block' : 'none';
  document.getElementById('sourceMenu').style.display = 'none';
});

document.querySelectorAll('.serviceBtn').forEach(btn => {
  btn.addEventListener('click', () => {
    selectedService = btn.getAttribute('data-service');
    document.getElementById('sourceMenu').style.display = 'block';
  });
});

document.getElementById('manualCoords').addEventListener('click', () => {
  alert("–§–æ—Ä–º–∞ –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –≤–≤–æ–¥—É –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –ø–æ–∫–∏ –Ω–µ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–∞.");
});

document.getElementById('geoCoords').addEventListener('click', () => {
  if (!selectedService) {
    alert("–°–ø–æ—á–∞—Ç–∫—É –≤–∏–±–µ—Ä—ñ—Ç—å —Å–µ—Ä–≤—ñ—Å.");
    return;
  }

  if (!navigator.geolocation) {
    alert("–ì–µ–æ–ª–æ–∫–∞—Ü—ñ—è –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î—Ç—å—Å—è.");
    return;
  }

  document.getElementById('snapshotMenu').style.display = 'none';
  document.getElementById('sourceMenu').style.display = 'none';

  const loader = document.getElementById('loaderOverlay');
  const message = document.getElementById('loaderMessage');
  message.textContent = "";
  loader.style.display = 'flex';

  navigator.geolocation.getCurrentPosition(position => {
    const lat = position.coords.latitude;
    const lon = position.coords.longitude;
    const today = new Date().toISOString().slice(0, 10);
    let url = "";

    if (selectedService === "nasa") {
      url = `https://worldview.earthdata.nasa.gov/?v=${lon-0.5},${lat-0.5},${lon+0.5},${lat+0.5}&t=${today}&l=MODIS_Terra_CorrectedReflectance_TrueColor`;
    } else if (selectedService === "sentinel") {
      url = `https://apps.sentinel-hub.com/sentinel-playground/?lat=${lat}&lng=${lon}&zoom=13&layer=1_TRUE_COLOR&date=${today}&atmFilter=BOTTOM&showDates=false`;
    } else if (selectedService === "zoom") {
      url = `https://zoom.earth/#view=${lat},${lon},10z/date=${today}`;
    }

    // —Å–æ–∑–¥–∞—ë–º —Å—Å—ã–ª–∫—É –∏ –∫–ª–∏–∫–∞–µ–º
    const a = document.createElement('a');
    a.href = url;
    a.target = '_blank';
    a.rel = 'noopener';
    document.body.appendChild(a);
    a.click();
    a.remove();

    loader.style.display = 'none'; // —Å–∫—Ä—ã–≤–∞–µ–º —Å—Ä–∞–∑—É
  }, error => {
    alert("–ù–µ –≤–¥–∞–ª–æ—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ –≥–µ–æ–ª–æ–∫–∞—Ü—ñ—é: " + error.message);
    loader.style.display = 'none';
  });
});
</script></body>
</html>
